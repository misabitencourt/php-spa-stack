var app=function(){"use strict";function e(s){return new Promise(function(i,r){function a(e,n){try{var t=s[n?"throw":"next"](e)}catch(e){return void r(e)}t.done?i(t.value):Promise.resolve(t.value).then(a,o)}function o(e){a(e,1)}a()})}var a=[{id:"config",name:"Configurações",description:"Configurações gerais",icon:"conf"},{id:"regs",name:"Cadastros",description:"Cadastros",icon:"regs"}],o=[{id:"users",name:"Usuários",description:"Cadastro de usuários",group:"config",route:"#users"},{id:"salesmen",name:"Vendedores",description:"Cadastro de vendedores",group:"regs",route:"#salesmen"},{id:"products",name:"Produtos",description:"Cadastro de produtos",group:"regs",route:"#products"},{id:"sales",name:"Vendas",description:"Cadastro de vendas",group:"regs",route:"#sales"}],r=window.hyperapp.h,l=function(e){var n=e.name,t=e.w,i=e.he;return r("img",{src:"public/assets/img/"+n+".svg",width:t,height:i})},s=window.hyperapp.h,c=window.hyperapp.h,u=window.hyperapp.h,d=window.hyperapp.h,t=function(e,n,t){return d("div",{id:"app"},["login"===e.page?d("span"):function(e){var n=e.title,t=void 0===n?"Salesman":n;e.state,e.actions;return s("div",{className:"navbar nav-tabs navbar-light bg-primary text-white"},[s("div",{className:"navbar-brand text-white",title:t},[l({name:"brand",w:40,he:40})]),s("ul",{className:"nav nav-tabs"},a.map(function(n){return s("li",{className:"nav-item dropdown"},[s("a",{href:"javascript:;",className:"nav-link dropdown-toggle",title:n.description},[s("span",{className:"hidden-sm"},n.name),s("span",{className:"hidden-lg"},[l({name:n.icon,w:32,he:32})])]),s("div",{className:"dropdown-menu"},o.filter(function(e){return e.group===n.id}).map(function(e){return s("a",{href:e.route,className:"dropdown-item"},e.name)}))])}))])}({title:"Salesman",state:e,actions:n}),d("div",{className:"container pt-4 pb-5"},t),e.pushNotifications.length?e.pushNotifications.map(function(e){return function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:"primary",n=arguments[1];return c("div",{className:"alert alert-"+e+" push-notification"},n)}(e.type,e.msg)}):d("span"),e.confirm?(i=e,r=n,u("div",{className:"confirm-wrp"},[u("div",{className:"confirm-inner"},[u("div",{className:"row"},[u("div",{className:"col-md-8 pt-2"},[u("p",{className:"text-white"},i.confirm.msg)]),u("div",{className:"col-md-4 text-md-right"},[u("button",{className:"btn btn-success mr-3",onclick:function(){r.confirmOk()}},"Sim"),u("button",{className:"btn btn-danger",onclick:function(){r.confirmCancel()}},"Não")])])])])):d("span")]);var i,r},i=function(t){return e(regeneratorRuntime.mark(function e(){var n;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch(t,{credentials:"same-origin"});case 2:if(401!==(n=e.sent).status){e.next=6;break}return sessionStorage.clear(),e.abrupt("return",window.location.reload());case 6:return e.next=8,n.json();case 8:return e.abrupt("return",e.sent);case 9:case"end":return e.stop()}},e,this)})())},m=function(t,i){return e(regeneratorRuntime.mark(function e(){var n;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch(t,{method:"POST",body:i,credentials:"same-origin"});case 2:if(500!==(n=e.sent).status&&400!==n.status){e.next=7;break}return e.next=6,n.text();case 6:throw e.sent;case 7:if(401!==n.status){e.next=10;break}return sessionStorage.clear(),e.abrupt("return",window.location.reload());case 10:return e.next=12,n.json();case 12:return e.abrupt("return",e.sent);case 13:case"end":return e.stop()}},e,this)})())},f=function(t,i){return e(regeneratorRuntime.mark(function e(){var n;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch(t,{method:"PUT",body:JSON.stringify(i),credentials:"same-origin"});case 2:if(500!==(n=e.sent).status&&400!==n.status){e.next=7;break}return e.next=6,n.text();case 6:throw e.sent;case 7:if(401!==n.status){e.next=10;break}return sessionStorage.clear(),e.abrupt("return",window.location.reload());case 10:return e.next=12,n.json();case 12:return e.abrupt("return",e.sent);case 13:case"end":return e.stop()}},e,this)})())},p=function(t){return e(regeneratorRuntime.mark(function e(){var n;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch(t,{method:"DELETE",credentials:"same-origin"});case 2:if(401!==(n=e.sent).status){e.next=6;break}return sessionStorage.clear(),e.abrupt("return",window.location.reload());case 6:return e.next=8,n.json();case 8:return e.abrupt("return",e.sent);case 9:case"end":return e.stop()}},e,this)})())},h=function(i){return e(regeneratorRuntime.mark(function e(){var n,t;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("/api/login/",{method:"POST",credentials:"same-origin",body:i});case 2:if(401!==(n=e.sent).status){e.next=7;break}throw"INVALID_CREDENTIALS";case 7:if(200===n.status){e.next=9;break}throw new Error;case 9:return e.next=11,n.json();case 11:return t=e.sent,e.abrupt("return",t);case 13:case"end":return e.stop()}},e,this)})())},n=function(){return e(regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,i("/api/permissions/");case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}},e,this)})())};var v=function(n){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:"";return e(regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,i("/api/"+n+"/"+(t?"?search="+encodeURIComponent(t):""));case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}},e,this)})())},b=function(n,t){return e(regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,m("/api/"+n+"/",t);case 3:return e.abrupt("return",e.sent);case 6:throw e.prev=6,e.t0=e.catch(0),e.t0;case 9:case"end":return e.stop()}},e,this,[[0,6]])})())},g=function(n,t,i){return e(regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,f("/api/"+n+"/"+i+"/",t);case 3:return e.abrupt("return",e.sent);case 6:throw e.prev=6,e.t0=e.catch(0),e.t0;case 9:case"end":return e.stop()}},e,this,[[0,6]])})())},w=function(n,t){return e(regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,p("/api/"+n+"/"+t+"/");case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}},e,this)})())},N="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};function y(e,n){if("checkbox"!==n.type)if(n.classList&&n.classList.contains("date")){if(!n.value)return void(e[n.name]="");var t=n.value.split("/").map(function(e){return 1*e});if(3!==t.length)return void(e[n.name]="");var i=new Date(t[2],t[1]-1,t[0]);e[n.name]=dayjs(i).format("YYYY-DD-MM")}else e[n.name]=n.value;else e[n.name]=n.checked}var x={formSubmit:function(o){return function(e,n){o.preventDefault();var t=o.target.dataset.model,i=Object.assign({},e.inEdition);if(i.id)g(t,i,i.id).then(function(){n.submenu("list"),n.pushNotificationShow({type:"success",msg:"Atualizado com sucesso"})}).catch(function(e){n.pushNotificationShow({type:"danger",msg:e||"Erro ao salvar registro"})});else{var r=new FormData;for(var a in e.inEdition)"object"!==N(e.inEdition[a])?r.set(a,e.inEdition[a]):r.set(a,JSON.stringify(e.inEdition[a]));b(t,r).then(function(){n.submenu("list"),n.pushNotificationShow({type:"success",msg:"Salvo com sucesso"})}).catch(function(e){n.pushNotificationShow({type:"danger",msg:e||"Erro ao salvar registro"})})}return e.loading=!0,Object.assign({},e)}},loginSubmit:function(i){return function(e,n){i.preventDefault();var t=new FormData(i.target);return h(t).then(function(e){sessionStorage.setItem("user",JSON.stringify(e)),window.location.reload()}).catch(function(e){"INVALID_CREDENTIALS"===e?n.pushNotificationShow({type:"danger",msg:"Login incorreto"}):console.log("NOT_ERROR")}),Object.assign({},e)}},pushNotificationShow:function(t){return function(e,n){return e.pushNotifications=[t].concat(function(e){if(Array.isArray(e)){for(var n=0,t=Array(e.length);n<e.length;n++)t[n]=e[n];return t}return Array.from(e)}(e.pushNotifications)),setTimeout(function(){n.pushNotificationHide(t)},5e3),Object.assign({},e)}},pushNotificationHide:function(t){return function(e,n){return e.pushNotifications.splice(e.pushNotifications.indexOf(t),1),Object.assign({},e)}},fetchGrid:function(t,i){return function(e,n){v(t,i).then(function(e){return n.fillGrid({model:t,items:e})})}},fillGrid:function(e){var i=e.model,r=e.items;return function(e,n){var t=e.lists.find(function(e){return e.id===i});return t||(t={id:i,items:[]},e.lists.push(t)),t.items.splice(0,t.items.length),r.forEach(function(e){return t.items.push(e)}),Object.assign({},e)}},submenu:function(n){return function(e){return e.submenu=n,e.inEdition={},Object.assign({},e)}},gridSearch:function(e){var t=e.model,i=e.value;return function(e,n){v(t,i).then(function(e){return n.fillGrid({model:t,items:e})})}},gridSelection:function(e){e.model;var t=e.item;return function(e,n){return n.submenu("form"),e.inEdition=Object.assign({},t),Object.assign({},e)}},editField:function(i){return function(e,n){var t=i.target;return i.childrenList&&""+i.childIndex?y(e.inEdition[i.childrenList][i.childIndex],t):y(e.inEdition,t),Object.assign({},e)}},deleteRegisterConfirm:function(t){return function(e,n){return e.confirm={msg:"Deseja mesmo excluir este registro?",ok:function(){n.deleteRegister(t)}},Object.assign({},e)}},deleteRegister:function(t){return function(e,n){w(t,e.inEdition.id).then(function(){n.submenu("list"),n.pushNotificationShow({type:"success",msg:"Registro deletado com sucesso"})})}},confirmOk:function(){return function(e,n){return e.confirm.ok&&e.confirm.ok(),e.confirm=null,Object.assign({},e)}},confirmCancel:function(){return function(e,n){return e.confirm.cancel&&e.confirm.cancel(),e.confirm=null,Object.assign({},e)}},entityModelSearch:function(e){var i=e.parent,r=e.model,a=e.value;return function(e,n){var t=i+"_"+r;v(r,a).then(function(e){n.entitySearchFill({identifier:t,items:e})})}},entitySearchFill:function(e){var i=e.identifier,r=e.items;return function(e,n){var t=e.lists.find(function(e){return e.model===i});return t&&e.lists.splice(e.lists.indexOf(t),1),e.lists.push({model:i,value:r}),Object.assign({},e)}},addChildrenInEdition:function(e){var t=e.children;return function(e,n){return e.inEdition=e.inEdition||{},e.inEdition[t]=e.inEdition[t]||[],e.inEdition[t].push({}),Object.assign({},e)}},removeChildrenInEdition:function(e){var t=e.children,i=e.index;return function(e,n){return e.inEdition=e.inEdition||{},e.inEdition[t]=e.inEdition[t]||[],e.inEdition[t].splice(i,1),Object.assign({},e)}}},E=window.hyperapp.h,k=window.hyperapp.h,S=window.hyperapp.h,j=window.hyperapp.h,_=function(e){var n,t,i,r,a,o=e.model,s=e.cols,c=e.state,u=e.actions,d=e.searchMethod,m=void 0===d?"string":d,l=c.lists.find(function(e){return e.id===o})||{items:[]};return j("div",{className:"table-wrp"},[j("table",{className:"table table-bordered table-stripped bg-white",oncreate:function(){return u.fetchGrid(o,"")}},[j("thead",{},[j("tr",{},[j("th",{className:"bg-primary text-md-right",colSpan:s.length},[j("div",{className:"row"},[j("div",{className:"col-md-6"}),j("div",{className:"col-md-6"},[(n={searchMethod:m,model:o,state:c,actions:u},t=n.searchMethod,i=n.model,r=n.state,a=n.actions,"date-range"===t?j("div",{className:"row"},[j("div",{className:"col-md-4"},[j("label",{className:"text-white"},"Entre (inicio)"),j("input",{type:"text",name:"__search_start",className:"form-control text-white date",placeholder:"DD/MM/YYYY",value:r.inEdition.__search_start?dayjs(r.inEdition.__search_start).format("DD/MM/YYYY"):"",onchange:function(e){return a.editField(e)}})]),j("div",{className:"col-md-4"},[j("label",{className:"text-white"},"Entre (fim)"),j("input",{type:"text",name:"__search_end",className:"form-control text-white date",placeholder:"DD/MM/YYYY",value:r.inEdition.hire_date?dayjs(r.inEdition.__search_end).format("DD/MM/YYYY"):"",onchange:function(e){return a.editField(e)}})]),j("div",{className:"col-md-4 text-md-left pt-3"},[j("button",{className:"btn btn-primary text-white",onclick:function(){a.gridSearch({model:i,value:r.inEdition.__search_start+"--"+r.inEdition.__search_end})}},"Pesquisar")])]):j("input",{type:"text",className:"form-control text-white",placeholder:"Pesquisar",onkeyup:function(e){window.keydownTimeout&&window.clearTimeout(window.keydownTimeout),window.keydownTimeout=window.setTimeout(function(){a.gridSearch({model:i,value:e.target.value})},800)}}))])])])]),j("tr",{},s.map(function(e){return j("th",{className:"bg-primary text-white"},e.name)}))]),j("tbody",{},l.items.map(function(n){return j("tr",{className:"pointer",onclick:function(){return u.gridSelection({model:o,item:n})}},s.map(function(e){return j("td",{},e.format?e.format(n[e.id]):n[e.id])}))}))])])},R=window.hyperapp.h,D=window.hyperapp.h,Y=window.hyperapp.h,O=window.hyperapp.h,F=[{id:0,name:"Produto"},{id:1,name:"Serviço"}],L=function(e){return isNaN(e)?"":"R$"+parseFloat(e).toFixed(2).split(".").join(",")},C=window.hyperapp.h,M=F.map(function(e){return C("option",{value:e.id},e.name)}),q=window.hyperapp.h,T=window.hyperapp.h,I=function(e){var n=e.state,t=e.actions,i=e.parent,r=e.model,a=e.descriptionProp,o=e.childrenList,s=void 0===o?null:o,c=e.childIndex,u=void 0===c?null:c,d=n.lists.find(function(e){return e.model===i+"_"+r});console.log(n.inEdition);var m=void 0;return m=s?n.inEdition&&n.inEdition[s][u][r]:n.inEdition&&n.inEdition[r],T("div",{className:"entity-select"},[m?T("div",{className:"row"},[T("div",{className:"col-md-9 pt-2 description"},m[a]||""),T("div",{className:"col-md-3"},[T("button",{className:"btn btn-sm btn-default",type:"button",onclick:function(){t.editField({target:{name:r,value:null,childrenList:s,childIndex:u}})}},[l({name:"delete",w:24,he:24})])])]):T("input",{className:"form-control",placeholder:"Pesquisar",onkeyup:function(e){window.searchDebounce&&window.clearTimeout(window.searchDebounce),window.searchDebounce=setTimeout(function(){t.entityModelSearch({parent:i,model:r,value:e.target.value})},800)}}),!m&&d&&d.value.length?T("ul",{className:"dropdown-menu always-visible"},d.value.map(function(e){return T("li",{className:"dropdown-item",onclick:function(){t.editField({target:{name:r,value:e},childrenList:s,childIndex:u})}},e[a])})):T("div")])},P=window.hyperapp.h,A=window.hyperapp.h,V=[{id:"home",mount:function(e,n){return E("div",{className:"page-home"},[E("div",{className:"row"},[E("div",{className:"col-md-12"},[E("h1",{},"Bem vindo")])])])}},{id:"login",mount:function(e,n){return S("div",{className:"login"},[(t="Login",i=[S("form",{onsubmit:n.loginSubmit},[S("input",{className:"form-control mb-2",required:!0,placeholder:"E-mail",type:"text",name:"email"}),S("input",{className:"form-control mb-2",required:!0,placeholder:"Senha",type:"password",name:"password"}),S("div",{className:"text-md-center"},[S("button",{className:"btn btn-primary",type:"submit"},"Entrar")])])],k("div",{className:"card"},[t?k("div",{className:"card-header bg-primary text-white"},[k("h5",{className:"mb-0"},t)]):k("span"),k("div",{className:"card-body"},i)]))]);var t,i}},{id:"users",mount:function(e,n){return D("div",{className:"page-user"},[D("div",{className:"row mb-3"},[D("div",{className:"col-md-8"},[D("h1",{},"Usuários")]),D("div",{className:"col-md-4 text-md-right pt-3"},["form"===e.submenu?D("a",{href:"javascript:;",onclick:function(){return n.submenu("list")}},[l({name:"list",w:32,h:32})]):D("a",{href:"javascript:;",onclick:function(){return n.submenu("form")}},[l({name:"add",w:32,h:32})])])]),"form"===e.submenu?(t=e,i=n,R("form",{onsubmit:function(e){return i.formSubmit(e)},"data-model":"users"},[R("div",{className:"row"},[R("div",{className:"col-md-4 form-group"},[R("label",{},"Nome"),R("input",{type:"text",name:"name",className:"form-control",required:!0,value:t.inEdition.name||"",onchange:function(e){return i.editField(e)}})]),R("div",{className:"col-md-4 form-group"},[R("label",{},"E-mail"),R("input",{type:"mail",name:"email",className:"form-control",required:!0,value:t.inEdition.email||"",onchange:function(e){return i.editField(e)}})]),R("div",{className:"col-md-4 form-group"},[R("label",{},"Senha"),R("input",{type:"password",name:"password",className:"form-control",required:!0,value:t.inEdition.password||"",onchange:function(e){return i.editField(e)}})])]),R("div",{className:"text-md-right mt-3"},[R("button",{className:"btn btn-success mr-3",type:"submit"},"Salvar"),t.inEdition.id?R("button",{className:"btn btn-danger",type:"button",onclick:function(){i.deleteRegisterConfirm("users")}},"Excluir"):R("span")])])):_({model:"users",cols:[{id:"name",name:"Nome"},{id:"email",name:"E-mail"}],state:e,actions:n})]);var t,i}},{id:"salesmen",mount:function(e,n){return O("div",{className:"page-salesman"},[O("div",{className:"row mb-3"},[O("div",{className:"col-md-8"},[O("h1",{},"Vendedores")]),O("div",{className:"col-md-4 text-md-right pt-3"},["form"===e.submenu?O("a",{href:"javascript:;",onclick:function(){return n.submenu("list")}},[l({name:"list",w:32,h:32})]):O("a",{href:"javascript:;",onclick:function(){return n.submenu("form")}},[l({name:"add",w:32,h:32})])])]),"form"===e.submenu?(t=e,i=n,Y("form",{onsubmit:function(e){return i.formSubmit(e)},"data-model":"salesmen"},[Y("div",{className:"row"},[Y("div",{className:"col-md-4 form-group"},[Y("label",{},"Nome"),Y("input",{type:"text",name:"name",className:"form-control",value:t.inEdition.name||"",required:!0,onchange:function(e){return i.editField(e)}})]),Y("div",{className:"col-md-4 form-group"},[Y("label",{},"E-mail"),Y("input",{type:"mail",name:"email",className:"form-control",value:t.inEdition.email||"",required:!0,onchange:function(e){return i.editField(e)}})]),Y("div",{className:"col-md-4 form-group"},[Y("label",{},"Telefone"),Y("input",{type:"tel",name:"phone",className:"form-control",value:t.inEdition.phone||"",required:!0,onchange:function(e){return i.editField(e)}})])]),Y("div",{className:"row"},[Y("div",{className:"col-md-4 form-group"},[Y("label",{},"Data de admissão"),Y("input",{type:"text",name:"hire_date",className:"form-control date",placeholder:"DD/MM/YYYY",required:!0,value:t.inEdition.hire_date?dayjs(t.inEdition.hire_date).format("DD/MM/YYYY"):"",onchange:function(e){return i.editField(e)}})])]),Y("div",{className:"text-md-right mt-3"},[Y("button",{className:"btn btn-success mr-3",type:"submit"},"Salvar"),t.inEdition.id?Y("button",{className:"btn btn-danger",type:"button",onclick:function(){i.deleteRegisterConfirm("users")}},"Excluir"):Y("span")])])):_({model:"salesmen",cols:[{id:"name",name:"Nome"},{id:"email",name:"E-mail"},{id:"phone",name:"Telfone"},{id:"hire_date",name:"Data de admissão",format:function(e){return dayjs(e).format("DD/MM/YYYY")}}],state:e,actions:n})]);var t,i}},{id:"sales",mount:function(e,n){return A("div",{className:"page-products"},[A("div",{className:"row mb-3"},[A("div",{className:"col-md-8"},[A("h1",{},"Vendas")]),A("div",{className:"col-md-4 text-md-right pt-3"},["form"===e.submenu?A("a",{href:"javascript:;",onclick:function(){return n.submenu("list")}},[l({name:"list",w:32,h:32})]):A("a",{href:"javascript:;",onclick:function(){return n.submenu("form")}},[l({name:"add",w:32,h:32})])])]),"form"===e.submenu?(t=e,i=n,t.inEdition&&t.inEdition.id?P("h3",{},"Em breve.... Funcionalidade de cancelar venda"):P("form",{onsubmit:function(e){return i.formSubmit(e)},"data-model":"sales"},[P("div",{className:"row"},[P("div",{className:"col-md-4 form-group"},[P("label",{},"Vendedor"),I({state:t,actions:i,parent:"sales",model:"salesmen",descriptionProp:"name"})]),P("div",{className:"col-md-4 form-group text-md-center"},[P("label",{}," "),P("div",{className:"pt-1"}),P("label",{className:"chk-box"},[P("input",{type:"checkbox",name:"_existed_client",onchange:function(e){i.editField(e)}}),P("span",{className:"ml-1"},"Cliente já cadastrado?")])]),t.inEdition._existed_client?P("div",{className:"col-md-4 form-group"},[P("label",{},"Cliente"),I({state:t,actions:i,parent:"sales",model:"customers",descriptionProp:"name"})]):P("div",{className:"col-md-4 form-group"},[P("label",{},"Nome do cliente"),P("input",{type:"text",name:"customer_name",className:"form-control",value:t.inEdition.customer_name||"",required:!0,onchange:function(e){return i.editField(e)}})])]),P("div",{className:"row mt-2"},[P("div",{className:"col-md-12 form-group"},[P("label",{},"Observações"),P("input",{type:"text",name:"obs",className:"form-control",value:t.inEdition.obs||"",onchange:function(e){return i.editField(e)}})])]),P("div",{className:"row mt-4"},[P("div",{className:"col-md-9"},[P("h4",{},"Produtos")]),P("div",{className:"col-md-3 text-md-right"},[P("button",{className:"btn btn-sm btn-primary",type:"button",onclick:function(){i.addChildrenInEdition({children:"items"})}},[l({name:"add",w:24,he:24})])])]),t.inEdition.items&&t.inEdition.items.length?P("div",{},[P("div",{className:"row"},[P("div",{className:"col-md-4"},[P("h5",{},"Produto")]),P("div",{className:"col-md-4"},[P("h5",{},"Quantidade")])]),t.inEdition.items.map(function(e,n){return P("div",{className:"row mt-3"},[P("div",{className:"col-md-4"},[I({state:t,actions:i,parent:"sales_items_"+n,model:"products",descriptionProp:"name",childrenList:"items",childIndex:n})]),P("div",{className:"col-md-4 form-group"},[P("input",{type:"number",name:"qt",className:"form-control",required:!0,step:"1",min:1,max:999,value:t.inEdition.items[n].qt?t.inEdition.items[n].qt:"",onchange:function(e){e.childrenList="items",e.childIndex=n,i.editField(e)}})]),P("div",{className:"col-md-4 form-group"},[P("button",{className:"btn btn-default btn-sm",type:"button",onclick:function(){i.removeChildrenInEdition({index:n,children:"items"})}},[l({name:"delete",w:24,he:24})])])])})]):P("div",{className:"row"},[P("div",{className:"col-md-12"},[P("h4",{className:"text-warning"},"Nenhum produto selecionado")])]),P("div",{className:"text-md-right mt-5"},[P("button",{className:"btn btn-success mr-3",type:"submit"},"Salvar"),t.inEdition.id?P("button",{className:"btn btn-danger",type:"button",onclick:function(){i.deleteRegisterConfirm("products")}},"Excluir"):P("span")])])):_({model:"sales",searchMethod:"date-range",cols:[{id:"salesman",name:"Vendedor",format:function(e){return e?e.name:""}},{id:"created_at",name:"Data",format:function(e){return dayjs(e).format("DD/MM/YYYY")}},{id:"total_price",name:"Valor total",format:function(e){return L(e)}},{id:"total_comission",name:"Comissão",format:function(e){return L(e)}}],state:e,actions:n})]);var t,i}},{id:"products",mount:function(e,n){return q("div",{className:"page-products"},[q("div",{className:"row mb-3"},[q("div",{className:"col-md-8"},[q("h1",{},"Produtos")]),q("div",{className:"col-md-4 text-md-right pt-3"},["form"===e.submenu?q("a",{href:"javascript:;",onclick:function(){return n.submenu("list")}},[l({name:"list",w:32,h:32})]):q("a",{href:"javascript:;",onclick:function(){return n.submenu("form")}},[l({name:"add",w:32,h:32})])])]),"form"===e.submenu?(t=e,i=n,C("form",{onsubmit:function(e){return i.formSubmit(e)},"data-model":"products"},[C("div",{className:"row"},[C("div",{className:"col-md-4 form-group"},[C("label",{},"Nome"),C("input",{type:"text",name:"name",className:"form-control",value:t.inEdition.name||"",required:!0,onchange:function(e){return i.editField(e)}})]),C("div",{className:"col-md-4 form-group"},[C("label",{},"Descrição"),C("input",{type:"text",name:"description",className:"form-control",value:t.inEdition.description||"",required:!0,onchange:function(e){return i.editField(e)}})]),C("div",{className:"col-md-4 form-group"},[C("label",{},"Tipo"),C("select",{name:"type",className:"form-control",value:""+t.inEdition.type||"",required:!0,onchange:function(e){return i.editField(e)}},M)])]),C("div",{className:"row"},[C("div",{className:"col-md-4 form-group"},[C("label",{},"Valor"),C("input",{type:"number",name:"price",className:"form-control",required:!0,step:"0.01",value:t.inEdition.price||"",onchange:function(e){return i.editField(e)}})])]),C("div",{className:"text-md-right mt-3"},[C("button",{className:"btn btn-success mr-3",type:"submit"},"Salvar"),t.inEdition.id?C("button",{className:"btn btn-danger",type:"button",onclick:function(){i.deleteRegisterConfirm("products")}},"Excluir"):C("span")])])):_({model:"products",cols:[{id:"name",name:"Nome"},{id:"type",name:"Tipo",format:function(n){var e=F.find(function(e){return e.id===n});return e?e.name:"Produto"}},{id:"price",name:"Valor",format:function(e){return L(e)}}],state:e,actions:n})]);var t,i}}];window.addEventListener("click",function(e){!function(e){var n=e.target;do{if(n.classList.contains("dropdown"))break;n=n.parentElement}while(n);if(n){var t=n.querySelector(".dropdown-menu");if(t){if(n.classList.contains("show"))return n.classList.remove("show"),t.classList.remove("show");Array.from(document.querySelectorAll(".dropdown.show, .dropdown-menu.show")).forEach(function(e){return e.classList.remove("show")}),n.classList.add("show"),t.classList.add("show")}}else Array.from(document.querySelectorAll(".dropdown.show, .dropdown-menu.show")).forEach(function(e){e.classList.remove("show")})}(e)});var G=window.hyperapp.app,U=!!sessionStorage.user,H=function(){return(""+window.location.hash).split("#").join("")||"home"},J={pushNotifications:[],lists:[],confirm:null,loading:!1,inEdition:{}};J.page=U?H():"login";var z=function(e,n){return console.log("Update!"),t(e,n,[function(n,e){var t=V.find(function(e){return e.id===n.page});if(!t)throw new Error("Page not found");return t.mount(n,e)}(e,n)])},B=function(){return e(regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!U){e.next=4;break}return e.next=3,n();case 3:J.permissions=e.sent;case 4:G(Object.assign(J),Object.assign(x),z,document.body);case 5:case"end":return e.stop()}},e,this)})())};return window.addEventListener("hashchange",function(){document.body.innerHTML="";var e=H();J.page=e,B()}),B}();
